<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Love Line Lens</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Quicksand:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Quicksand', sans-serif;
      background-image: url('/static/bg1.jpeg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-color: #1b1a2d;
      color: #eee;
      min-height: 100vh;
    }

    section {
      padding: 3rem 1rem;
      max-width: 1100px;
      margin: auto;
      text-align: center;
    }

    h1 {
      font-family: 'Cinzel', serif;
      font-size: 3.5rem;
      color: #ffeaa7;
      text-shadow: 2px 2px 6px #000;
    }

    #upload-section {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 2.5rem 2rem;
      max-width: 650px;
      margin: 2rem auto;
      box-shadow: 0 0 25px rgba(255, 255, 255, 0.05);
    }

    .hidden {
      display: none;
    }

    input[type="file"] {
      background: #fff;
      color: #2d3436;
      padding: 0.7rem 1rem;
      margin-top: 0.7rem;
      margin-bottom: 1.2rem;
      border-radius: 8px;
      border: none;
      width: 100%;
      max-width: 400px;
    }

    button {
      margin-top: 1rem;
      padding: 0.8rem 2.5rem;
      background: linear-gradient(135deg, #a29bfe, #81ecec);
      color: #2d3436;
      border-radius: 8px;
      font-size: 1.1rem;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(129, 236, 236, 0.3);
    }

    .result-box {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      margin-top: 3rem;
      flex-wrap: wrap;
    }

    .result-img {
      width: 300px;
      background: #111;
      border-radius: 16px;
      padding: 1rem;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    .result-img img {
      width: 100%;
      border-radius: 12px;
      border: 2px solid #ffeaa7;
    }

    .love-icon {
      font-size: 3rem;
      color: #ff7675;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .palm-type {
      margin-top: 0.5rem;
      font-weight: bold;
      font-size: 1.2rem;
      color: #ffeaa7;
    }

    .compatibility-text {
      margin-top: 2rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      font-size: 1.2rem;
      padding: 1.5rem;
      border-left: 4px solid #ffeaa7;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.08);
      background: linear-gradient(to right, rgba(255,255,255,0.07), rgba(255,255,255,0.03));
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: break-word;
      text-align: left;
    }

    .typewriter::after {
      content: '|';
      animation: blink 1s infinite;
      color: #ffeaa7;
      margin-left: 4px;
    }

    @keyframes blink {
      0%, 50%, 100% { opacity: 1; }
      25%, 75% { opacity: 0; }
    }

    .loader {
      border: 6px solid #333;
      border-top: 6px solid #ffeaa7;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin: auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
    <div id="floating-hearts"></div>
    <style>
      #floating-hearts {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
      }
    
      .heart {
        position: absolute;
        width: 20px;
        height: 20px;
        background: pink;
        transform: rotate(45deg);
        animation: floatHeart 8s infinite ease-in;
      }
    
      .heart::before,
      .heart::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        background: pink;
        border-radius: 50%;
      }
    
      .heart::before {
        top: -10px;
        left: 0;
      }
    
      .heart::after {
        left: -10px;
        top: 0;
      }
    
      @keyframes floatHeart {
        0% {
          bottom: -20px;
          opacity: 0;
        }
        30% {
          opacity: 1;
        }
        100% {
          bottom: 100%;
          opacity: 0;
          transform: translateX(100px) rotate(720deg);
        }
      }
    </style>
    <script>
      // Spawn floating hearts randomly
      setInterval(() => {
        const heart = document.createElement("div");
        heart.classList.add("heart");
        heart.style.left = Math.random() * 100 + "vw";
        heart.style.background = ["#ff6b81", "#fab1a0", "#fd79a8"][Math.floor(Math.random() * 3)];
        heart.style.animationDuration = 5 + Math.random() * 5 + "s";
        document.getElementById("floating-hearts").appendChild(heart);
    
        setTimeout(() => heart.remove(), 10000);
      }, 400);
    </script>
<form id="upload-form" method="POST" enctype="multipart/form-data" action="/compatibility">
  <section id="upload-section">
    <h1>Love Line Lens</h1>
    <p>Upload both palms and see your compatibility spark!</p>

    <label for="file1">Palm Image 1</label><br>
    <input type="file" name="file1" id="file1" accept="image/*" required><br>

    <label for="file2">Palm Image 2</label><br>
    <input type="file" name="file2" id="file2" accept="image/*" required><br>

    <button type="submit">Begin Scan</button>
  </section>
</form>

<section id="result-section" class="hidden">
  <div id="loader" class="loader"></div>

  <div class="result-box" style="display:none;">
    <div class="result-img">
      <img id="img1" src="">
      <div id="palm1-type" class="palm-type"></div>
    </div>

    <div class="love-icon">❤️</div>

    <div class="result-img">
      <img id="img2" src="">
      <div id="palm2-type" class="palm-type"></div>
    </div>
  </div>

  <div id="compatibility-text" class="compatibility-text hidden typewriter"></div>
</section>

<script>
const form = document.getElementById("upload-form");
const loader = document.getElementById("loader");
const resultBox = document.querySelector(".result-box");
const resultSection = document.getElementById("result-section");
const img1 = document.getElementById("img1");
const img2 = document.getElementById("img2");
const palm1Type = document.getElementById("palm1-type");
const palm2Type = document.getElementById("palm2-type");
const compatibilityText = document.getElementById("compatibility-text");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const file1 = document.getElementById("file1").files[0];
  const file2 = document.getElementById("file2").files[0];

  if (!file1 || !file2) {
    alert("Please upload both palm images.");
    return;
  }

  resultSection.classList.remove("hidden");
  loader.style.display = "block";
  resultBox.style.display = "none";
  compatibilityText.classList.add("hidden");
  compatibilityText.textContent = "";

  const formData = new FormData();
  formData.append("file1", file1);
  formData.append("file2", file2);

  try {
    const response = await fetch("/compatibility", {
      method: "POST",
      body: formData
    });

    const data = await response.json();

    setTimeout(() => {
      loader.style.display = "none";
      resultBox.style.display = "flex";

      img1.src = data.image1_url;
      img2.src = data.image2_url;

      palm1Type.textContent = data.palm_type1 + " hand";
      palm2Type.textContent = data.palm_type2 + " hand";

      compatibilityText.classList.remove("hidden");

      // Typewriter effect
      const fullText = data.compatibility_text;
      let i = 0;
      const speed = 35;

      function typeWriter() {
        if (i < fullText.length) {
          compatibilityText.textContent += fullText.charAt(i);
          i++;
          setTimeout(typeWriter, speed);
        }
      }

      typeWriter();
    }, 2000);

  } catch (error) {
    console.error("Error during compatibility check:", error);
  }
});
// Show spark and match meter
document.getElementById("spark-animation").classList.remove("hidden");



</script>

</body>
</html>